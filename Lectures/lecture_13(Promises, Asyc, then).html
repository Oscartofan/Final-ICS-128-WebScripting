<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>"Oscar Fernando Varela Revelo - ICS 128 - Lab #1</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <script src="js/script.js"></script>
	<link rel="stylesheet" href="css/styles.css">
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
    <script src="js/script.js"></script>

    <h1>Lecture 11</h1>


    <script>
      let promiseToCleanTheRoom = new Promise(function(resolve, reject) {
        let isClean = true;

        if (isClean) {
          resolve('Clean');
        } else {
          reject('not Clean')
        }
      });

      promiseToCleanTheRoom.then(function (result) {
        console.log('The room is ' + result)
      }).catch(function(result) {
        console.log('The room is ' + result)
      });

      /*
      Normal systax to create a Promise

      var p = new Promise( function(resolve,reject) {
        // ........
      });

      Thenable can change value, a promise cannot change


      async/await is very similar to a Promise and is more easier to work

      */

      let resolve_after_2_seconds = () => {
        console.log('Starting Promise');
        return new Promise(resolve => {
          setTimeout(() => {
            resolve('resolved');
            console.log('Promise is completed');
          }, 2000);
        });
      }
      
      let async_call = async () => {
        console.log('calling...')
        let result = await resolve_after_2_seconds();
        console.log(result);
        // expected output: 'resolved';
      }

      async_call();

      const makeAPICall = async () => {
        try {
          let respose = await fetch('https://128.compsci.ccc/json/json_demo.tx');
          console.log(respose.status); //200
          console.log(respose.statusText); //OK
          if (respose.status === 200) {
            let data = await respose.json();
            console.log(data);
          }
        } catch (e) {
          console.log("We had a hiccup, maybe we should fetch a different URL");
          let respose = await fetch('https://128.compsci.cc/json/json_demo.txt');
          console.log(respose.status); // 200
          console.log(respose.statusText); //OK
          if (respose.status === 200) {
            let data = await respose.json();
            console.log(data);
          }
        }
      }

//       async function getSomeText() {
      // try block {
      // let response = await fetch('/someFile.txt');
        // if CORRECT{
          // let dataFile = await response.text();
          // console.log(dataFile);
        //}
      //} CATCH (Possible error) {
        //the same as above but with different URL to fetch!
      //}
      
      
      
      // }

      makeAPICall();
    </script>
  </body>
</html>